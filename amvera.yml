# Amvera auto-deploy configuration for KindPlate
# Place this file in repository root and push to trigger build

version: 1

compose: docker-compose.yml

env:
  # Backend
  - key: DATABASE_URL
    required: true
    description: PostgreSQL connection string (service postgres inside compose)
  - key: SECRET_KEY
    required: true
    description: Session secret for cookie-session
  - key: FRONTEND_ORIGIN
    required: true
    description: Public frontend URL, e.g. https://app.kindplate.ru

  # Frontend
  - key: VITE_BACKEND_BASE_URL
    required: true
    description: Public backend URL, e.g. https://api.kindplate.ru
  - key: VITE_VAPID_PUBLIC_KEY
    required: false
    description: Optional web-push VAPID public key

domains:
  - host: app.kindplate.ru
    service: frontend
    port: 80
  - host: api.kindplate.ru
    service: backend
    port: 5000

auto_deploy:
  enabled: true
  on_push_branches:
    - main

health_checks:
  backend:
    path: /
    port: 5000
    interval: 15s
    timeout: 5s
  frontend:
    path: /
    port: 80
    interval: 15s
    timeout: 5s


